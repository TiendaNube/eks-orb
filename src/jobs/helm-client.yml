description: |
  Allows use the helm client to work with Amazon EKS.
parameters:
  namespace:
    description: A specific namespace
    type: string
  command:
    description: |
      Available Commands:
      completion  Generate autocompletions script for the specified shell (bash or zsh)
      create      create a new chart with the given name
      delete      given a release name, delete the release from Kubernetes
      dependency  manage a chart's dependencies
      diff        Preview helm upgrade changes as a diff
      fetch       download a chart from a repository and (optionally) unpack it in local directory
      get         download a named release
      help        Help about any command
      history     fetch release history
      home        displays the location of HELM_HOME
      init        initialize Helm on both client and server
      inspect     inspect a chart
      install     install a chart archive
      lint        examines a chart for possible issues
      list        list releases
      package     package a chart directory into a chart archive
      plugin      add, list, or remove Helm plugins
      repo        add, list, remove, update, and index chart repositories
      reset       uninstalls Tiller from a cluster
      rollback    roll back a release to a previous revision
      s3          The plugin allows to use s3 protocol to upload, fetch charts and to work with repositories.
      search      search for a keyword in charts
      serve       start a local http web server
      status      displays the status of the named release
      template    locally render templates
      test        test a release
      upgrade     upgrade a release
      verify      verify that a chart at the given path has been signed and is valid
      version     print the client/server version information
    type: string
  args:
    description: Arguments to the command selected
    type: string

steps:
  - run:
      name: Helm client command
      command: |
        NAMESPACE="<< parameters.namespace >>"
        COMMAND="<< parameters.command >>"
        ARGS="<< parameters.args>>"

        if [ -n "${COMMAND}" ]; then
          set -- "$@" "${COMMAND}"
        fi
        if [ -n "${NAMESPACE}" ]; then
          set -- "$@" --namespace "${NAMESPACE}"
        fi
        if [ -n "${ARGS}" ]; then
          set -- "$@" "${ARGS}"
        fi

        helm "$@"
